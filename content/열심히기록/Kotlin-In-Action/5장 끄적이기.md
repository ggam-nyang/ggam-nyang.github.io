---
emoji: 🌱
title: Kotlin-in-Action 5장
date: '2023-03-25 22:00:00'
author: 지구깜냥
tags: Kotlin 코틀린 코틀린인액션 Kotlin-in-Action 개발자 Developer
categories: Kotlin
---
### Kotlin-in-Action
5장 람다로 프로그래밍
람다는 다른 함수에 넘길 수 있는 작은 코드 조각
```kotlin
data class Person(val name: String, val age: Int)
```
`Person` 리스트의 age가 가장 높은 원소를 찾는다면

```kotlin
fun findTheOldest(people: List<Person>) {
    var maxAge = 0
    var theOldest: Person? = null
    for (person in people) {
        if (person.age > maxAge) {
            maxAge = person.age
            theOldest = person
        }
    }
}
```
`maxAge, theOldest` 두 변수가 필요하다.

람다를 활용한다면 코드 길이가 줄어든다.

```kotlin
people.maxBy { it.age }
people.maxBy(Person::age) // 멤버 참조 이용
people.maxBy({ p: Person -> p.age }) // 코틀린의 지원 없는 정석적인 표현
```

마지막 줄을 개선해보자. <br>
함수의 마지막 인자가 람다 식이라면 중괄호로 뺄 수 있다. <br>
`people.maxBy() { p:Person -> p.age }`

람다가 유일한 인자고 괄호로 뺐다면 빈 괄호를 없앨 수 있다.
`people.maxBy { p:Person -> p.age }`

파라미터 타입을 명시하지 않고(컴파일러가 추론) 한개의 파라미터라면 더 코드를 줄인다.
<br>`people.maxBy { it.age }`

<br>

자바 무명 클래스처럼 람다를 함수 안에서 정의하면 함수의 파라미터뿐 아니라 람다 정의 앞에 선언된 로컬 변수까지 람다에서 사용할 수 있다.
```kotlin
fun printMessagesWithPrefix(messages: Collection<String>, prefix: String) {
    messages.forEach {
        println("$prefix $it")
    }
}
```

람다 내부에서 변수 접근이 가능하고, 변경도 가능하다.

이런 변수를 람다가 포획한 변수라고 하는데, 어떤 함수가 로컬 변수를 포획한 람다를 반환 or 변수에 저장한다면 포획된 로컬 변수의 생명주기와 함수의 생명주기가 달라 질 수 있다.
```kotlin
fun tryToCountButtonClicks(button: Button) : Int {
    var clicks = 0
    button.onClick { clicks++ }
    return clicks
}
```
이 함수는 항상 0을 반환한다.<br>
onclick 핸들러가 `tryToCOuntButtonClicks`가 `clicks`를 반환한 후에 호출되기 때문

-> 무슨 의미일까?

멤버 참조는 다음처럼 사용 가능하다.
```kotlin
val p = Person("Dmitry", 34)
val personsAgeFunction = Person::age
println(personsAgeFunction(p))

// 바운드 멤버 참조
val dmitrysAgeFunction = p::age
println(dmitrysAgeFunction())
```
